# ================================================================
한글 프로그래밍 언어 문법 명세서 v3.8.0
> 변경: 통계 함수 13종 + AI 활성함수 3종 + 호감도 함수(관계심리) 추가,
>       올림/내림 자릿수 인수 추가, 최대/최소 배열 입력 지원

-----

## 1. 파일 확장자

-----

소스파일   : .han
컴파일결과 : .exe , .apk , .ipa
헤더      : .hg

-----

## 2. 주석

-----

한줄 주석  : // 이것은 주석입니다
여러줄 주석: /*
여러 줄에 걸친
주석입니다
*/

-----

## 3. 자료형

-----

### 기본 자료형

정수        - 소수점 없는 숫자           예) 1, -5, 100
실수        - 소수점 있는 숫자           예) 3.14, -0.5
문자        - 문자 하나                  예) '가', 'A'
글자        - 문자 여러개                예) "안녕하세요"
논리        - 참 또는 거짓               예) 참, 거짓
없음        - 값이 없음 (null)
2진         - 2진법 리터럴               예) 0b1010
8진         - 8진법 리터럴               예) 0o17
16진        - 16진법 리터럴              예) 0xFF

### 확장 자료형

행렬        - 다차원 행렬 (matrix)
사진        - 이미지 데이터 타입
그림        - 캔버스/렌더링 타입
함수형      - 일급 함수 타입

### 자료구조 타입

배열        - 동적 배열 (array)
사전        - 키-값 쌍 (dictionary)
목록        - 구조체 정의 (struct)
객체        - 클래스 (class)
열거        - 열거형 (enum)
틀          - 인터페이스 (interface)

-----

## 4. 변수 선언

-----

형식: [자료형] [변수이름] = [값]

예)
정수 나이 = 25
실수 키 = 175.5
글자 이름 = "홍길동"
논리 성인여부 = 참
문자 첫문자 = '홍'

상수 선언 (값 변경 불가):
고정 정수 최대값 = 100

-----

## 5. 연산자

-----

### 산술 연산자

+   더하기
-   빼기
*   곱하기
/   나누기
%   나머지
**  거듭제곱

### 비교 연산자

==  같다
!=  다르다
>   크다
<   작다
>=  크거나같다
<=  작거나같다

### 논리 연산자

그리고   (AND)
또는     (OR)
아니다   (NOT)

예)
만약 나이 >= 18 그리고 나이 <= 65:

### 비트 연산자

&   비트 AND
|   비트 OR
^   비트 XOR
~   비트 NOT
<<  왼쪽 시프트
>>  오른쪽 시프트

### 대입 연산자

=   기본 대입
+=  더하기 대입
-=  빼기 대입
*=  곱하기 대입
/=  나누기 대입
%=  나머지 대입

-----

## 6. 조건문

-----

형식:
만약 [조건]:
    [실행내용]
아니면 만약 [조건]:
    [실행내용]
아니면:
    [실행내용]

예)
만약 점수 >= 90:
    출력("A등급")
아니면 만약 점수 >= 80:
    출력("B등급")
아니면:
    출력("C등급 이하")

-----

## 7. 반복문

-----

### 횟수 반복

반복 [변수] 부터 [시작] 까지 [끝]:
    [실행내용]

```
예)
반복 i 부터 1 까지 10:
    출력(i)
```

### 조건 반복

동안 [조건]:
    [실행내용]

```
예)
동안 횟수 < 10:
    횟수 = 횟수 + 1
```

### 목록 순회

각각 [변수] 안에 [목록]:
    [실행내용]

```
예)
각각 이름 안에 이름목록:
    출력(이름)
```

### 반복 제어

멈춤    - 반복 즉시 종료 (break)
건너뜀  - 다음 반복으로 이동 (continue)

-----

## 8. 분기문 (Select)

-----

선택 [조건]
    경우 [일치하는 값]:
        [내용]
    그외:
        [내용]

```
예)
선택 이름
    경우 "홍길동":
        출력("홍길동")
    경우 "아버지":
        출력("아버지")
    그외:
        출력("일치하는 이름 없음")
```

-----

## 9. 강제 이동 (goto)

-----

이동 [이름]

이름:

-----

## 10. 함수

-----

### 반환값이 있는 함수

형식:
함수 [함수이름]([매개변수]):
    [실행내용]
    반환 [값]

예)
함수 더하기(정수 가, 정수 나):
    반환 가 + 나

### 반환값이 없는 함수 (void)

형식:
정의 [함수이름]([매개변수]):
    [실행내용]
    끝냄

예)
정의 인사(글자 이름):
    출력("안녕하세요, " + 이름)
    끝냄

### 가변 매개변수

형식: [자료형] [이름]...

예)
함수 합계(정수 값...):
    반환 값

### 람다 (익명 함수)

형식: ([매개변수]) => [표현식]

예)
함수형 두배 = (정수 x) => x * 2
함수형 덧셈 = (정수 가, 정수 나) => 가 + 나
함수형 빈람다 = () => 42

-----

## 11. 배열

-----

### 배열 리터럴

배열 이름 = [값1, 값2, 값3]

예)
배열 숫자들 = [1, 2, 3, 4, 5]
배열 이름들 = ["홍길동", "김철수"]

### 인덱스 접근

배열이름[인덱스]

예)
출력(숫자들[0])     // 첫 번째 원소
숫자들[1] = 99      // 두 번째 원소 수정

### 배열 멤버

배열이름.길이       // 배열 원소 개수

-----

## 12. 사전

-----

### 사전 리터럴

사전 이름 = {키1: 값1, 키2: 값2}

예)
사전 정보 = {"이름": "홍길동", "나이": 25}

### 사전 접근

정보["이름"]
정보.이름

-----

## 13. 객체 (클래스)

-----

### 클래스 선언

객체 [이름] [이어받기 부모클래스]:
    [속성 및 메서드]

예)
객체 사람:
    글자 이름
    정수 나이

    함수 생성(글자 이름, 정수 나이):
        자신.이름 = 이름
        자신.나이 = 나이

    함수 인사():
        출력("안녕하세요, " + 자신.이름)

### 상속

객체 학생 이어받기 사람:
    글자 학교

    함수 생성(글자 이름, 정수 나이, 글자 학교):
        부모.생성(이름, 나이)
        자신.학교 = 학교

### 멤버 접근

객체이름.속성
객체이름.메서드()
자신        // 현재 객체 (this/self)
부모        // 부모 클래스 (super)
생성        // 생성자 (constructor)

-----

## 14. 예외 처리

-----

시도:
    [실행 내용]
실패시:
    [오류 처리]
    // '오류' 변수로 오류 메시지 전달
항상:
    [항상 실행]

예)
시도:
    출력(10 / 0)
실패시:
    출력("오류 발생: " + 오류)
항상:
    출력("정리 완료")

### 오류 발생

오류([오류 메시지])

예)
오류("잘못된 입력입니다")

-----

## 15. 모듈 가져오기

-----

형식:
가짐 [모듈이름]
가짐 [모듈이름] 로부터 [이름1, 이름2, ...]

예)
가짐 수학
가짐 파일시스템 로부터 읽기, 쓰기

-----

## 16. 입출력

-----

출력([값])           // 줄바꿈 포함 출력
출력없이([값])       // 줄바꿈 없는 출력
입력([안내문자열])   // 사용자 입력 받기
파일열기([경로])     // 파일 열기

예)
출력("안녕하세요")
출력없이("로딩 중")
글자 이름 = 입력("이름을 입력하세요: ")

-----

## 17. 내장 함수

-----

| 함수명      | 설명                                   |
|-------------|----------------------------------------|
| 출력(값)    | 값을 출력하고 줄바꿈                   |
| 출력없이(값)| 값을 출력하고 줄바꿈 없음              |
| 입력(안내)  | 사용자 입력 한 줄 읽기                 |
| 길이(값)    | 문자열 또는 배열의 길이 반환           |
| 범위(끝)    | 0부터 끝까지 정수 배열 생성            |
| 범위(시작, 끝) | 시작부터 끝까지 정수 배열 생성      |
| 범위(시작, 끝, 간격) | 간격 단위 정수 배열 생성      |
| 정수(값)    | 정수로 형변환 (값은 숫자·글자·배열 가능) |
| 실수(값)    | 실수로 형변환 (값은 숫자·글자·배열 가능) |
| 글자(값)    | 문자열로 형변환                        |
| 추가(배열, 값) | 배열 끝에 값 추가                   |
| 제곱근(값)  | 제곱근 계산 (값은 숫자 또는 실수 반환) |
| 절댓값(값)  | 절댓값 계산 (값은 숫자 또는 배열)      |
| 최대(값, ...) | 최댓값 반환 — 가변 인수 또는 배열 1개 허용 |
| 최소(값, ...) | 최솟값 반환 — 가변 인수 또는 배열 1개 허용 |
| **수학 기초 (v3.7.1 / v3.8.0 확장)** | |
| 올림(값, 자릿수=0) | ceiling — 올림. 올림(3.14,1)→3.2, 올림(3.1)→4 |
| 내림(값, 자릿수=0) | floor — 내림. 내림(3.99,1)→3.9, 내림(3.9)→3   |
| 반올림(값, 자릿수=0) | 자릿수 지정 반올림. 반올림(3.456,2)→3.46, 반올림(3.4)→3 |
| 사인(값)    | sin(라디안) 반환                       |
| 코사인(값)  | cos(라디안) 반환                       |
| 탄젠트(값)  | tan(라디안) 반환                       |
| 자연로그(값)| ln(x) = log_e(x) 반환                 |
| 로그(밑, 값)| log_밑(값) 반환                       |
| 지수(값)    | e^x 반환                               |
| `파이`      | π = 3.14159... (상수)                  |
| `오일러`    | e = 2.71828... (상수)                  |
| **통계 함수 (v3.8.0 추가)** | |
| 합계(배열)  | 배열 원소의 합 반환                    |
| 평균(배열)  | 배열 원소의 산술 평균 반환             |
| 분산(배열, 표본=0) | 모분산(표본=0) 또는 표본분산(표본=1) 반환 |
| 표준편차(배열, 표본=0) | 표준편차 반환 (분산의 제곱근)  |
| 중앙값(배열) | 배열을 정렬했을 때 중앙 값 반환       |
| 최빈값(배열) | 가장 많이 나타나는 값 반환 (동점 시 첫 번째) |
| 누적합(배열) | 누적 합 배열 반환. [1,2,3]→[1.0,3.0,6.0] |
| 공분산(배열, 배열, 표본=0) | 두 배열의 공분산 반환       |
| 상관계수(배열, 배열) | 피어슨 상관계수 r 반환 (−1 ~ 1) |
| 정규화(배열) | Min-Max 정규화 → [0, 1] 범위 배열 반환 |
| 표준화(배열) | Z-score 표준화 → 평균 0, 분산 1 배열 반환 |
| 배열정렬(배열, 내림차순=0) | 정렬된 새 배열 반환. 배열정렬(arr,1) = 내림차순 |
| 배열뒤집기(배열) | 순서를 뒤집은 새 배열 반환            |
| **AI 활성함수 (v3.8.0 추가)** | |
| 시그모이드(값) | σ(x)=1/(1+e^-x) — 숫자 또는 배열 원소 각각 적용 |
| 렐루(값)    | ReLU(x)=max(0,x) — 숫자 또는 배열 원소 각각 적용 |
| 쌍곡탄젠트(값) | tanh(x) — 숫자 또는 배열 원소 각각 적용       |
| **AI / 수학 함수 (v3.6.0 추가)** | |
| 평균제곱오차(예측, 실제) | MSE = (1/N)Σ(y-ŷ)² — 회귀 손실 함수  |
| 교차엔트로피(P_star, P) | H = -ΣP*(i)logP(i) — 분류 손실 함수  |
| 소프트맥스(배열)        | yᵢ = eᵃⁱ/Σeᵃʲ — 확률 분포 변환      |
| 위치인코딩(위치, 차원수) | sin/cos 교대 인코딩 — Transformer PE |
| 등비수열합(a, r)        | 무한 등비급수 a/(1-r), \|r\|<1        |
| 등차수열합(a, d, n)     | n/2*(2a+(n-1)d) — n항까지 합          |
| 점화식값(a1, r, n)      | a1*r^(n-1) — 등비 점화식 n번째 항    |
| **관계 심리 함수 (v3.8.0 추가)** | |
| 호감도(T, S, C, R) | 기본 평균형 L = (T+S+C+R)/4 → 실수 반환 |
| 호감도(T, S, C, R, α, β, γ, δ) | 가중합형 L = αT+βS+γC+δR — 계수 직접 지정 |
| 호감도([T,S,C,R]) | 배열 평균형 — 4원소 배열 입력 |
| 호감도([T,S,C,R], [α,β,γ,δ]) | 배열 가중합형 — 두 배열 입력 |

> **호감도 변수 정의**
> - T (Trust): 신뢰 — 상대를 얼마나 믿는가
> - S (Similarity): 유사성 — 가치관·관심사의 공통점
> - C (Communication): 소통 — 대화의 질과 빈도
> - R (Reward): 행복감 — 함께 있을 때 느끼는 긍정적 감정
> - α,β,γ,δ: 개인별 가중치 (합이 1.0이면 정규화된 결과)
> - 각 인수 권장 범위: 0.0 ~ 1.0

### 호감도 함수 사용 예시

```
// ① 기본 평균형 — 네 요소를 동등하게 가중
실수 결과 = 호감도(0.8, 0.6, 0.9, 0.7)
출력(결과)   // (0.8+0.6+0.9+0.7)/4 = 0.75

// ② 가중합형 — 사람마다 다른 계수 적용
// 신뢰를 가장 중요하게 여기는 사람
실수 결과2 = 호감도(0.8, 0.6, 0.9, 0.7,  0.4, 0.2, 0.2, 0.2)
출력(결과2)  // 0.4*0.8 + 0.2*0.6 + 0.2*0.9 + 0.2*0.7 = 0.76

// ③ 배열 평균형
배열 요소 = [0.8, 0.6, 0.9, 0.7]
출력(호감도(요소))  // 0.75

// ④ 배열 가중합형 — 소통을 중요시하는 사람
배열 가중치 = [0.2, 0.2, 0.4, 0.2]
출력(호감도(요소, 가중치))  // 0.76

// ⑤ 관계 변화 시뮬레이션
배열 시간별_신뢰  = [0.3, 0.5, 0.7, 0.85]
배열 시간별_소통  = [0.5, 0.6, 0.65, 0.8]
배열 시간별_유사  = [0.4, 0.45, 0.5, 0.55]
배열 시간별_행복  = [0.4, 0.6, 0.7, 0.9]

반복 i 부터 0 까지 3:
    실수 l = 호감도(시간별_신뢰[i], 시간별_유사[i],
                   시간별_소통[i], 시간별_행복[i])
    출력("t=" + 글자(i) + " 호감도=" + 글자(l))
```

### 통계 함수 사용 예시

```
// 기술 통계
배열 점수 = [70.0, 85.0, 90.0, 60.0, 95.0]
출력(합계(점수))         // 400.0
출력(평균(점수))         // 80.0
출력(분산(점수))         // 146.0  (모분산)
출력(분산(점수, 1))      // 182.5  (표본분산)
출력(표준편차(점수))     // 12.083...
출력(중앙값(점수))       // 85.0
출력(최빈값(점수))       // 70.0 (모두 1회이므로 첫값)
출력(누적합(점수))       // [70.0, 155.0, 245.0, 305.0, 400.0]

// 최대/최소 — 배열 직접 입력 가능
출력(최대(점수))         // 95.0
출력(최소(점수))         // 60.0

// 올림/내림 자릿수 지정
출력(올림(3.14, 1))      // 3.2
출력(내림(3.99, 1))      // 3.9
출력(올림(314, -2))      // 400

// 상관 분석
배열 키  = [160.0, 170.0, 180.0]
배열 몸무게 = [55.0, 68.0, 80.0]
출력(상관계수(키, 몸무게))  // 1.0 (완전 양의 상관)
출력(공분산(키, 몸무게))    // 83.333...

// 데이터 전처리
출력(정규화(점수))       // [0.143, 0.714, 0.857, 0.0, 1.0]
출력(표준화(점수))       // Z-score 배열
출력(배열정렬(점수))     // [60.0, 70.0, 85.0, 90.0, 95.0]
출력(배열정렬(점수, 1))  // [95.0, 90.0, 85.0, 70.0, 60.0] 내림차순
출력(배열뒤집기(점수))   // [95.0, 60.0, 90.0, 85.0, 70.0]
```

### AI 활성함수 사용 예시

```
// 단일값
출력(시그모이드(0.0))    // 0.5
출력(렐루(-3.0))         // 0.0
출력(쌍곡탄젠트(1.0))   // 0.7616...

// 배열 원소 일괄 적용 (원소별 변환)
배열 로짓 = [-1.0, 0.0, 1.0, 2.0]
출력(시그모이드(로짓))  // [0.269, 0.5, 0.731, 0.880]
출력(렐루(로짓))         // [0.0, 0.0, 1.0, 2.0]
출력(쌍곡탄젠트(로짓)) // [-0.762, 0.0, 0.762, 0.964]
```

```
// ① 평균제곱오차 — 회귀 모델 손실 계산
배열 예측 = [2.5, 0.0, 2.0, 8.0]
배열 실제  = [3.0, -0.5, 2.0, 7.0]
실수 손실 = 평균제곱오차(예측, 실제)
출력(손실)   // 0.1875

// ② 교차엔트로피 — 분류 모델 손실 (원-핫 레이블)
배열 정답분포 = [0.0, 1.0, 0.0]
배열 예측분포 = [0.1, 0.7, 0.2]
실수 손실2 = 교차엔트로피(정답분포, 예측분포)
출력(손실2)  // 0.3567...

// ③ 소프트맥스 — 신경망 출력층 (다중 분류)
배열 로짓 = [1.0, 2.0, 3.0]
배열 확률 = 소프트맥스(로짓)
출력(확률)   // [0.09, 0.245, 0.665] 합계=1.0

// ④ 위치인코딩 — Transformer PE 벡터 생성
배열 pe = 위치인코딩(0, 4)   // 위치 0, 차원 4
출력(pe)     // [sin(0), cos(0), sin(0/100), cos(0/100)]

// ⑤ 등비수열합 — 무한 등비급수 수렴값
실수 합 = 등비수열합(1.0, 0.5)   // 1/(1-0.5) = 2.0
출력(합)

// ⑥ 등차수열합 — 1+2+...+100
실수 합2 = 등차수열합(1.0, 1.0, 100)   // 5050.0
출력(합2)

// ⑦ 점화식값 — a₁=2, r=3 인 등비수열의 5번째 항
실수 항 = 점화식값(2.0, 3.0, 5)   // 2*3^4 = 162.0
출력(항)
```

### 배열 내장 속성

배열.길이    // 배열 원소 수
문자열.길이  // 문자열 길이

-----

## 18. 전처리기 디렉티브

-----

전처리기 구문은 `#` 뒤에 한글 키워드를 붙여 사용합니다.

```
#정의 [이름] [값]           // 상수 또는 매크로 정의
#포함 [파일명]              // 외부 파일 포함
#만약 [조건]                // 조건부 컴파일 시작
#아니면                     // 조건부 컴파일 분기
#끝                         // 조건부 컴파일 종료
#만약있으면 [이름]          // 이름이 정의된 경우
#만약없으면 [이름]          // 이름이 정의되지 않은 경우
#GPU사용                    // GPU 가속 활성화
```

예)
```
#정의 최대크기 100
#포함 "수학라이브러리.hg"

#만약있으면 디버그
    출력("디버그 모드")
#끝
```

-----

## 19. GPU 블록

-----

가속기: 키워드로 GPU 가속 연산 블록을 정의합니다.

```
가속기:
    // GPU에서 병렬 실행될 코드
    반복 i 부터 0 까지 1000:
        결과[i] = 데이터[i] * 2
가속기끝
```

-----

## 20. 스크립트 블록

-----

외부 언어 코드를 Kcode 내부에 직접 삽입하여 실행합니다.

### 파이썬 블록

```
파이썬:
    print("파이썬 코드")
파이썬끝
```

### 변수 전달 및 반환

```
파이썬(변수1, 변수2) => 반환변수:
    # 전달받은 변수 사용 가능
    result = 변수1 + 변수2
    print(result)
파이썬끝
```

### 자바 블록

```
자바:
    public class Main {
        public static void main(String[] args) {
            System.out.println("자바 실행!");
        }
    }
자바끝
```

### 자바스크립트 블록

```
자바스크립트 => 결과:
    const arr = [1,2,3];
    console.log(arr.reduce((a,b)=>a+b,0));
자바스크립트끝
```

### 스크립트 블록 공통 문법

```
[언어키워드][(전달변수, ...)] [=> 반환변수]:
    [외부 언어 코드 원문]
끝[언어키워드]
```

| 언어 | 시작 | 종료 |
|------|------|------|
| Python | 파이썬 | 파이썬끝 |
| Java | 자바 | 자바끝 |
| JavaScript | 자바스크립트 | 자바스크립트끝 |

-----

## 21. 화면/렌더링 키워드

-----

화면      - 2D 윈도우 생성
화면3D    - 3D 윈도우 생성
사진열기  - 이미지 파일 열기
그림만들기 - 캔버스 생성

-----

## 22. AI 연결

-----

AI연결    - 외부 LLM 모델 연결

-----

## 23. 들여쓰기 규칙

-----

Python과 동일하게 들여쓰기 기반으로 블록을 구분합니다.
스페이스 또는 탭 일관되게 사용 (혼용 금지).
블록 시작은 `:` (콜론)으로 표시합니다.

예)
만약 조건:
    // 들여쓰기된 블록
    출력("블록 내부")
// 들여쓰기 종료 = 블록 종료

-----

## 24. 통합 예제

-----

```
// 모듈 가져오기
가짐 수학

// 상수 선언
고정 정수 최대 = 100

// 배열 및 사전
배열 점수 = [85, 92, 78, 95, 88]
사전 학생 = {"이름": "홍길동", "학년": 3}

// 함수 정의 (람다 포함)
함수형 두배 = (정수 x) => x * 2

함수 평균(배열 값들):
    정수 합 = 0
    각각 v 안에 값들:
        합 += v
    반환 합 / 길이(값들)

// 클래스 정의
객체 학생:
    함수 생성(글자 이름, 정수 점수):
        자신.이름 = 이름
        자신.점수 = 점수

    함수 등급():
        선택 자신.점수 / 10
            경우 10:
            경우 9:
                반환 "A"
            경우 8:
                반환 "B"
            그외:
                반환 "C 이하"

// 예외 처리
시도:
    정수 결과 = 10 / 0
실패시:
    출력("오류: " + 오류)

// 파이썬 연동
정수 평균값 = 0
파이썬(점수) => 평균값:
    print(int(sum(점수) / len(점수)))
파이썬끝

출력("평균: " + 글자(평균값))
```

-----
